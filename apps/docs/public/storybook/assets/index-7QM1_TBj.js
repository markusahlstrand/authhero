var fe=Object.defineProperty;var pe=(r,t,e)=>t in r?fe(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var d=(r,t,e)=>pe(r,typeof t!="symbol"?t+"":t,e);import{z as f}from"./adapter-interfaces-DorHxuyG.js";import{j as u}from"./AppLogo-gHPKz47t.js";var L;(function(r){r[r.Include=0]="Include",r[r.None=1]="None"})(L||(L={}));var B;(function(r){r[r.Required=0]="Required",r[r.Ignore=1]="Ignore"})(B||(B={}));function we(r){return D(r,be,U.Include)}function Z(r){return D(r,ge,U.None)}function D(r,t,e){let n="";for(let i=0;i<r.byteLength;i+=3){let s=0,o=0;for(let a=0;a<3&&i+a<r.byteLength;a++)s=s<<8|r[i+a],o+=8;for(let a=0;a<4;a++)o>=6?(n+=t[s>>o-6&63],o-=6):o>0?(n+=t[s<<6-o&63],o=0):e===U.Include&&(n+="=")}return n}const be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";var U;(function(r){r[r.Include=0]="Include",r[r.None=1]="None"})(U||(U={}));var $;(function(r){r[r.Required=0]="Required",r[r.Ignore=1]="Ignore"})($||($={}));class me{uint8(t,e){if(t.byteLength<e+1)throw new TypeError("Insufficient bytes");return t[e]}uint16(t,e){if(t.byteLength<e+2)throw new TypeError("Insufficient bytes");return t[e]<<8|t[e+1]}uint32(t,e){if(t.byteLength<e+4)throw new TypeError("Insufficient bytes");let n=0;for(let i=0;i<4;i++)n|=t[e+i]<<24-i*8;return n}uint64(t,e){if(t.byteLength<e+8)throw new TypeError("Insufficient bytes");let n=0n;for(let i=0;i<8;i++)n|=BigInt(t[e+i])<<BigInt(56-i*8);return n}putUint8(t,e,n){if(t.length<n+1)throw new TypeError("Not enough space");if(e<0||e>255)throw new TypeError("Invalid uint8 value");t[n]=e}putUint16(t,e,n){if(t.length<n+2)throw new TypeError("Not enough space");if(e<0||e>65535)throw new TypeError("Invalid uint16 value");t[n]=e>>8,t[n+1]=e&255}putUint32(t,e,n){if(t.length<n+4)throw new TypeError("Not enough space");if(e<0||e>4294967295)throw new TypeError("Invalid uint32 value");for(let i=0;i<4;i++)t[n+i]=e>>(3-i)*8&255}putUint64(t,e,n){if(t.length<n+8)throw new TypeError("Not enough space");if(e<0||e>18446744073709551615n)throw new TypeError("Invalid uint64 value");for(let i=0;i<8;i++)t[n+i]=Number(e>>BigInt((7-i)*8)&0xffn)}}const j=new me;function b(r,t){return(r<<32-t|r>>>t)>>>0}function ye(r){const t=new xe;return t.update(r),t.digest()}class xe{constructor(){d(this,"blockSize",64);d(this,"size",32);d(this,"blocks",new Uint8Array(64));d(this,"currentBlockSize",0);d(this,"H",new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]));d(this,"l",0n);d(this,"w",new Uint32Array(64))}update(t){if(this.l+=BigInt(t.byteLength)*8n,this.currentBlockSize+t.byteLength<64){this.blocks.set(t,this.currentBlockSize),this.currentBlockSize+=t.byteLength;return}let e=0;if(this.currentBlockSize>0){const n=t.slice(0,64-this.currentBlockSize);this.blocks.set(n,this.currentBlockSize),this.process(),e+=n.byteLength,this.currentBlockSize=0}for(;e+64<=t.byteLength;){const n=t.slice(e,e+64);this.blocks.set(n),this.process(),e+=64}if(t.byteLength-e>0){const n=t.slice(e);this.blocks.set(n),this.currentBlockSize=n.byteLength}}digest(){this.blocks[this.currentBlockSize]=128,this.currentBlockSize+=1,64-this.currentBlockSize<8&&(this.blocks.fill(0,this.currentBlockSize),this.process(),this.currentBlockSize=0),this.blocks.fill(0,this.currentBlockSize),j.putUint64(this.blocks,this.l,this.blockSize-8),this.process();const t=new Uint8Array(32);for(let e=0;e<8;e++)j.putUint32(t,this.H[e],e*4);return t}process(){for(let l=0;l<16;l++)this.w[l]=(this.blocks[l*4]<<24|this.blocks[l*4+1]<<16|this.blocks[l*4+2]<<8|this.blocks[l*4+3])>>>0;for(let l=16;l<64;l++){const h=(b(this.w[l-2],17)^b(this.w[l-2],19)^this.w[l-2]>>>10)>>>0,p=(b(this.w[l-15],7)^b(this.w[l-15],18)^this.w[l-15]>>>3)>>>0;this.w[l]=h+this.w[l-7]+p+this.w[l-16]|0}let t=this.H[0],e=this.H[1],n=this.H[2],i=this.H[3],s=this.H[4],o=this.H[5],a=this.H[6],c=this.H[7];for(let l=0;l<64;l++){const h=(b(s,6)^b(s,11)^b(s,25))>>>0,p=(s&o^~s&a)>>>0,g=c+h+p+ke[l]+this.w[l]|0,E=(b(t,2)^b(t,13)^b(t,22))>>>0,x=(t&e^t&n^e&n)>>>0,ue=E+x|0;c=a,a=o,o=s,s=i+g|0,i=n,n=e,e=t,t=g+ue|0}this.H[0]=t+this.H[0]|0,this.H[1]=e+this.H[1]|0,this.H[2]=n+this.H[2]|0,this.H[3]=i+this.H[3]|0,this.H[4]=s+this.H[4]|0,this.H[5]=o+this.H[5]|0,this.H[6]=a+this.H[6]|0,this.H[7]=c+this.H[7]|0}}const ke=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);new BigUint64Array([0x428a2f98d728ae22n,0x7137449123ef65cdn,0xb5c0fbcfec4d3b2fn,0xe9b5dba58189dbbcn,0x3956c25bf348b538n,0x59f111f1b605d019n,0x923f82a4af194f9bn,0xab1c5ed5da6d8118n,0xd807aa98a3030242n,0x12835b0145706fben,0x243185be4ee4b28cn,0x550c7dc3d5ffb4e2n,0x72be5d74f27b896fn,0x80deb1fe3b1696b1n,0x9bdc06a725c71235n,0xc19bf174cf692694n,0xe49b69c19ef14ad2n,0xefbe4786384f25e3n,0x0fc19dc68b8cd5b5n,0x240ca1cc77ac9c65n,0x2de92c6f592b0275n,0x4a7484aa6ea6e483n,0x5cb0a9dcbd41fbd4n,0x76f988da831153b5n,0x983e5152ee66dfabn,0xa831c66d2db43210n,0xb00327c898fb213fn,0xbf597fc7beef0ee4n,0xc6e00bf33da88fc2n,0xd5a79147930aa725n,0x06ca6351e003826fn,0x142929670a0e6e70n,0x27b70a8546d22ffcn,0x2e1b21385c26c926n,0x4d2c6dfc5ac42aedn,0x53380d139d95b3dfn,0x650a73548baf63den,0x766a0abb3c77b2a8n,0x81c2c92e47edaee6n,0x92722c851482353bn,0xa2bfe8a14cf10364n,0xa81a664bbc423001n,0xc24b8b70d0f89791n,0xc76c51a30654be30n,0xd192e819d6ef5218n,0xd69906245565a910n,0xf40e35855771202an,0x106aa07032bbd1b8n,0x19a4c116b8d2d0c8n,0x1e376c085141ab53n,0x2748774cdf8eeb99n,0x34b0bcb5e19b48a8n,0x391c0cb3c5c95a63n,0x4ed8aa4ae3418acbn,0x5b9cca4f7763e373n,0x682e6ff3d6b2b8a3n,0x748f82ee5defb2fcn,0x78a5636f43172f60n,0x84c87814a1f0ab72n,0x8cc702081a6439ecn,0x90befffa23631e28n,0xa4506cebde82bde9n,0xbef9a3f7b2c67915n,0xc67178f2e372532bn,0xca273eceea26619cn,0xd186b8c721c0c207n,0xeada7dd6cde0eb1en,0xf57d4f7fee6ed178n,0x06f067aa72176fban,0x0a637dc5a2c898a6n,0x113f9804bef90daen,0x1b710b35131c471bn,0x28db77f523047d84n,0x32caab7b40c72493n,0x3c9ebe0a15c9bebcn,0x431d67c49c100d4cn,0x4cc5d4becb3e42b6n,0x597f299cfc657e2an,0x5fcb6fab3ad6faecn,0x6c44198c4a475817n]);class W{constructor(t){d(this,"data");this.data=t}tokenType(){if("token_type"in this.data&&typeof this.data.token_type=="string")return this.data.token_type;throw new Error("Missing or invalid 'token_type' field")}accessToken(){if("access_token"in this.data&&typeof this.data.access_token=="string")return this.data.access_token;throw new Error("Missing or invalid 'access_token' field")}accessTokenExpiresInSeconds(){if("expires_in"in this.data&&typeof this.data.expires_in=="number")return this.data.expires_in;throw new Error("Missing or invalid 'expires_in' field")}accessTokenExpiresAt(){return new Date(Date.now()+this.accessTokenExpiresInSeconds()*1e3)}hasRefreshToken(){return"refresh_token"in this.data&&typeof this.data.refresh_token=="string"}refreshToken(){if("refresh_token"in this.data&&typeof this.data.refresh_token=="string")return this.data.refresh_token;throw new Error("Missing or invalid 'refresh_token' field")}hasScopes(){return"scope"in this.data&&typeof this.data.scope=="string"}scopes(){if("scope"in this.data&&typeof this.data.scope=="string")return this.data.scope.split(" ");throw new Error("Missing or invalid 'scope' field")}idToken(){if("id_token"in this.data&&typeof this.data.id_token=="string")return this.data.id_token;throw new Error("Missing or invalid field 'id_token'")}}function _e(r){const t=ye(new TextEncoder().encode(r));return Z(t)}function Y(){const r=new Uint8Array(32);return crypto.getRandomValues(r),Z(r)}function ve(r,t){if(t.length!==1)throw new TypeError("Invalid character string");let e=0;for(;e<r.length&&r[e]===t;)e++;return r.slice(e)}function M(r,t){if(t.length!==1)throw new TypeError("Invalid character string");let e=r.length;for(;e>0&&r[e-1]===t;)e--;return r.slice(0,e)}function N(r,...t){let e=M(r,"/");for(const n of t)e=M(e,"/")+"/"+ve(n,"/");return e}function y(r,t){const e=new TextEncoder().encode(t.toString()),n=new Request(r,{method:"POST",body:e});return n.headers.set("Content-Type","application/x-www-form-urlencoded"),n.headers.set("Accept","application/json"),n.headers.set("User-Agent","arctic"),n.headers.set("Content-Length",e.byteLength.toString()),n}function I(r,t){const e=new TextEncoder().encode(`${r}:${t}`);return we(e)}async function R(r){let t;try{t=await fetch(r)}catch(e){throw new H(e)}if(t.status===400||t.status===401){let e;try{e=await t.json()}catch{throw new k(t.status)}if(typeof e!="object"||e===null)throw new m(t.status,e);let n;try{n=P(e)}catch{throw new m(t.status,e)}throw n}if(t.status===200){let e;try{e=await t.json()}catch{throw new k(t.status)}if(typeof e!="object"||e===null)throw new m(t.status,e);return new W(e)}throw t.body!==null&&await t.body.cancel(),new k(t.status)}async function Ie(r){let t;try{t=await fetch(r)}catch(e){throw new H(e)}if(t.status===400||t.status===401){let e;try{e=await t.json()}catch{throw new m(t.status,null)}if(typeof e!="object"||e===null)throw new m(t.status,e);let n;try{n=P(e)}catch{throw new m(t.status,e)}throw n}if(t.status===200){t.body!==null&&await t.body.cancel();return}throw t.body!==null&&await t.body.cancel(),new k(t.status)}function P(r){let t;if("error"in r&&typeof r.error=="string")t=r.error;else throw new Error("Invalid error response");let e=null,n=null,i=null;if("error_description"in r){if(typeof r.error_description!="string")throw new Error("Invalid data");e=r.error_description}if("error_uri"in r){if(typeof r.error_uri!="string")throw new Error("Invalid data");n=r.error_uri}if("state"in r){if(typeof r.state!="string")throw new Error("Invalid data");i=r.state}return new Ae(t,e,n,i)}class H extends Error{constructor(t){super("Failed to send request",{cause:t})}}class Ae extends Error{constructor(e,n,i,s){super(`OAuth request error: ${e}`);d(this,"code");d(this,"description");d(this,"uri");d(this,"state");this.code=e,this.description=n,this.uri=i,this.state=s}}class k extends Error{constructor(e){super("Unexpected error response");d(this,"status");this.status=e}}class m extends Error{constructor(e,n){super("Unexpected error response body");d(this,"status");d(this,"data");this.status=e,this.data=n}}class S{constructor(t,e,n){d(this,"clientId");d(this,"clientPassword");d(this,"redirectURI");this.clientId=t,this.clientPassword=e,this.redirectURI=n}createAuthorizationURL(t,e,n){const i=new URL(t);return i.searchParams.set("response_type","code"),i.searchParams.set("client_id",this.clientId),this.redirectURI!==null&&i.searchParams.set("redirect_uri",this.redirectURI),i.searchParams.set("state",e),n.length>0&&i.searchParams.set("scope",n.join(" ")),i}createAuthorizationURLWithPKCE(t,e,n,i,s){const o=new URL(t);if(o.searchParams.set("response_type","code"),o.searchParams.set("client_id",this.clientId),this.redirectURI!==null&&o.searchParams.set("redirect_uri",this.redirectURI),o.searchParams.set("state",e),n===_.S256){const a=_e(i);o.searchParams.set("code_challenge_method","S256"),o.searchParams.set("code_challenge",a)}else n===_.Plain&&(o.searchParams.set("code_challenge_method","plain"),o.searchParams.set("code_challenge",i));return s.length>0&&o.searchParams.set("scope",s.join(" ")),o}async validateAuthorizationCode(t,e,n){const i=new URLSearchParams;i.set("grant_type","authorization_code"),i.set("code",e),this.redirectURI!==null&&i.set("redirect_uri",this.redirectURI),n!==null&&i.set("code_verifier",n),this.clientPassword===null&&i.set("client_id",this.clientId);const s=y(t,i);if(this.clientPassword!==null){const a=I(this.clientId,this.clientPassword);s.headers.set("Authorization",`Basic ${a}`)}return await R(s)}async refreshAccessToken(t,e,n){const i=new URLSearchParams;i.set("grant_type","refresh_token"),i.set("refresh_token",e),this.clientPassword===null&&i.set("client_id",this.clientId),n.length>0&&i.set("scope",n.join(" "));const s=y(t,i);if(this.clientPassword!==null){const a=I(this.clientId,this.clientPassword);s.headers.set("Authorization",`Basic ${a}`)}return await R(s)}async revokeToken(t,e){const n=new URLSearchParams;n.set("token",e),this.clientPassword===null&&n.set("client_id",this.clientId);const i=y(t,n);if(this.clientPassword!==null){const s=I(this.clientId,this.clientPassword);i.headers.set("Authorization",`Basic ${s}`)}await Ie(i)}}var _;(function(r){r[r.S256=0]="S256",r[r.Plain=1]="Plain"})(_||(_={}));var q;(function(r){r[r.Include=0]="Include",r[r.None=1]="None"})(q||(q={}));var V;(function(r){r[r.Required=0]="Required",r[r.Ignore=1]="Ignore"})(V||(V={}));function A(r){return Ue(r,Ce,z.None)}function Ue(r,t,e){let n="";for(let i=0;i<r.byteLength;i+=3){let s=0,o=0;for(let a=0;a<3&&i+a<r.byteLength;a++)s=s<<8|r[i+a],o+=8;for(let a=0;a<4;a++)o>=6?(n+=t[s>>o-6&63],o-=6):o>0?(n+=t[s<<6-o&63],o=0):e===z.Include&&(n+="=")}return n}const Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";var z;(function(r){r[r.Include=0]="Include",r[r.None=1]="None"})(z||(z={}));var O;(function(r){r[r.Required=0]="Required",r[r.Ignore=1]="Ignore"})(O||(O={}));function Ee(r,t,e){const n=A(new TextEncoder().encode(r)),i=A(new TextEncoder().encode(t)),s=A(e);return n+"."+i+"."+s}function Re(r,t){const e=A(new TextEncoder().encode(r)),n=A(new TextEncoder().encode(t)),i=e+"."+n;return new TextEncoder().encode(i)}const ze="https://appleid.apple.com/auth/authorize",Se="https://appleid.apple.com/auth/token";class Q{constructor(t,e,n,i,s){d(this,"clientId");d(this,"teamId");d(this,"keyId");d(this,"pkcs8PrivateKey");d(this,"redirectURI");this.clientId=t,this.teamId=e,this.keyId=n,this.pkcs8PrivateKey=i,this.redirectURI=s}createAuthorizationURL(t,e){const n=new URL(ze);return n.searchParams.set("response_type","code"),n.searchParams.set("client_id",this.clientId),n.searchParams.set("state",t),e.length>0&&n.searchParams.set("scope",e.join(" ")),n.searchParams.set("redirect_uri",this.redirectURI),n}async validateAuthorizationCode(t){const e=new URLSearchParams;e.set("grant_type","authorization_code"),e.set("code",t),e.set("redirect_uri",this.redirectURI),e.set("client_id",this.clientId);const n=await this.createClientSecret();e.set("client_secret",n);const i=y(Se,e);return await R(i)}async createClientSecret(){const t=await crypto.subtle.importKey("pkcs8",this.pkcs8PrivateKey,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]),e=Math.floor(Date.now()/1e3),n=JSON.stringify({typ:"JWT",alg:"ES256",kid:this.keyId}),i=JSON.stringify({iss:this.teamId,exp:e+5*60,aud:["https://appleid.apple.com"],sub:this.clientId,iat:e}),s=new Uint8Array(await crypto.subtle.sign({name:"ECDSA",hash:"SHA-256"},t,Re(n,i)));return Ee(n,i,s)}}const Te="https://www.facebook.com/v16.0/dialog/oauth",Pe="https://graph.facebook.com/v16.0/oauth/access_token";class X{constructor(t,e,n){d(this,"clientId");d(this,"clientSecret");d(this,"redirectURI");this.clientId=t,this.clientSecret=e,this.redirectURI=n}createAuthorizationURL(t,e){const n=new URL(Te);return n.searchParams.set("response_type","code"),n.searchParams.set("client_id",this.clientId),n.searchParams.set("state",t),e.length>0&&n.searchParams.set("scope",e.join(" ")),n.searchParams.set("redirect_uri",this.redirectURI),n}async validateAuthorizationCode(t){const e=new URLSearchParams;e.set("grant_type","authorization_code"),e.set("code",t),e.set("redirect_uri",this.redirectURI),e.set("client_id",this.clientId),e.set("client_secret",this.clientSecret);const n=y(Pe,e);return await R(n)}}const He="https://github.com/login/oauth/authorize",F="https://github.com/login/oauth/access_token";class ee{constructor(t,e,n){d(this,"clientId");d(this,"clientSecret");d(this,"redirectURI");this.clientId=t,this.clientSecret=e,this.redirectURI=n}createAuthorizationURL(t,e){const n=new URL(He);return n.searchParams.set("response_type","code"),n.searchParams.set("client_id",this.clientId),n.searchParams.set("state",t),e.length>0&&n.searchParams.set("scope",e.join(" ")),this.redirectURI!==null&&n.searchParams.set("redirect_uri",this.redirectURI),n}async validateAuthorizationCode(t){const e=new URLSearchParams;e.set("grant_type","authorization_code"),e.set("code",t),this.redirectURI!==null&&e.set("redirect_uri",this.redirectURI);const n=y(F,e),i=I(this.clientId,this.clientSecret);return n.headers.set("Authorization",`Basic ${i}`),await G(n)}async refreshAccessToken(t){const e=new URLSearchParams;e.set("grant_type","refresh_token"),e.set("refresh_token",t);const n=y(F,e),i=I(this.clientId,this.clientSecret);return n.headers.set("Authorization",`Basic ${i}`),await G(n)}}async function G(r){let t;try{t=await fetch(r)}catch(i){throw new H(i)}if(t.status!==200)throw t.body!==null&&await t.body.cancel(),new k(t.status);let e;try{e=await t.json()}catch{throw new k(t.status)}if(typeof e!="object"||e===null)throw new m(t.status,e);if("error"in e&&typeof e.error=="string"){let i;try{i=P(e)}catch{throw new m(t.status,e)}throw i}return new W(e)}const Le="https://accounts.google.com/o/oauth2/v2/auth",J="https://oauth2.googleapis.com/token",Be="https://oauth2.googleapis.com/revoke";class te{constructor(t,e,n){d(this,"client");this.client=new S(t,e,n)}createAuthorizationURL(t,e,n){return this.client.createAuthorizationURLWithPKCE(Le,t,_.S256,e,n)}async validateAuthorizationCode(t,e){return await this.client.validateAuthorizationCode(J,t,e)}async refreshAccessToken(t){return await this.client.refreshAccessToken(J,t,[])}async revokeToken(t){await this.client.revokeToken(Be,t)}}class ne{constructor(t,e,n,i){d(this,"authorizationEndpoint");d(this,"tokenEndpoint");d(this,"client");this.authorizationEndpoint=N("https://login.microsoftonline.com",t,"/oauth2/v2.0/authorize"),this.tokenEndpoint=N("https://login.microsoftonline.com",t,"/oauth2/v2.0/token"),this.client=new S(e,n,i)}createAuthorizationURL(t,e,n){return this.client.createAuthorizationURLWithPKCE(this.authorizationEndpoint,t,_.S256,e,n)}async validateAuthorizationCode(t,e){return await this.client.validateAuthorizationCode(this.tokenEndpoint,t,e)}async refreshAccessToken(t,e){return await this.client.refreshAccessToken(this.tokenEndpoint,t,e)}}const $e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let v=(r=21)=>{let t="",e=crypto.getRandomValues(new Uint8Array(r));for(;r--;)t+=$e[e[r]&63];return t};class re{constructor(t,e){d(this,"alphabet");d(this,"padding");d(this,"decodeMap",new Map);if(t.length!==32)throw new Error("Invalid alphabet");if(this.alphabet=t,this.padding=(e==null?void 0:e.padding)??"=",this.alphabet.includes(this.padding)||this.padding.length!==1)throw new Error("Invalid padding");for(let n=0;n<t.length;n++)this.decodeMap.set(t[n],n)}encode(t,e){let n="",i=0,s=0;for(let a=0;a<t.length;a++)for(i=i<<8|t[a],s+=8;s>=5;)s-=5,n+=this.alphabet[i>>s&31];if(s>0&&(n+=this.alphabet[i<<5-s&31]),(e==null?void 0:e.includePadding)??!0){const a=(8-n.length%8)%8;for(let c=0;c<a;c++)n+="="}return n}decode(t,e){const n=(e==null?void 0:e.strict)??!0,i=Math.ceil(t.length/8),s=[];for(let o=0;o<i;o++){let a=0;const c=[];for(let h=0;h<8;h++){const p=t[o*8+h];if(p==="="){if(o+1!==i)throw new Error(`Invalid character: ${p}`);a+=1;continue}if(p===void 0){if(n)throw new Error("Invalid data");a+=1;continue}const g=this.decodeMap.get(p)??null;if(g===null)throw new Error(`Invalid character: ${p}`);c.push(g)}if(a===8||a===7||a===5||a===2)throw new Error("Invalid padding");const l=(c[0]<<3)+(c[1]>>2);if(s.push(l),a<6){const h=((c[1]&3)<<6)+(c[2]<<1)+(c[3]>>4);s.push(h)}if(a<4){const h=((c[3]&255)<<4)+(c[4]>>1);s.push(h)}if(a<3){const h=((c[4]&1)<<7)+(c[5]<<2)+(c[6]>>3);s.push(h)}if(a<1){const h=((c[6]&7)<<5)+c[7];s.push(h)}}return Uint8Array.from(s)}}new re("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567");new re("0123456789ABCDEFGHIJKLMNOPQRSTUV");class ie{constructor(t,e){d(this,"alphabet");d(this,"padding");d(this,"decodeMap",new Map);if(t.length!==64)throw new Error("Invalid alphabet");if(this.alphabet=t,this.padding=(e==null?void 0:e.padding)??"=",this.alphabet.includes(this.padding)||this.padding.length!==1)throw new Error("Invalid padding");for(let n=0;n<t.length;n++)this.decodeMap.set(t[n],n)}encode(t,e){let n="",i=0,s=0;for(let a=0;a<t.length;a++)for(i=i<<8|t[a],s+=8;s>=6;)s+=-6,n+=this.alphabet[i>>s&63];if(s>0&&(n+=this.alphabet[i<<6-s&63]),(e==null?void 0:e.includePadding)??!0){const a=(4-n.length%4)%4;for(let c=0;c<a;c++)n+="="}return n}decode(t,e){const n=(e==null?void 0:e.strict)??!0,i=Math.ceil(t.length/4),s=[];for(let o=0;o<i;o++){let a=0,c=0;for(let l=0;l<4;l++){const h=t[o*4+l];if(h==="="){if(o+1!==i)throw new Error(`Invalid character: ${h}`);a+=1;continue}if(h===void 0){if(n)throw new Error("Invalid data");a+=1;continue}const p=this.decodeMap.get(h)??null;if(p===null)throw new Error(`Invalid character: ${h}`);c+=p<<6*(3-l)}s.push(c>>16&255),a<2&&s.push(c>>8&255),a<1&&s.push(c&255)}return Uint8Array.from(s)}}new ie("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");const K=new ie("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_");function je(r){const t=r.split(".");return t.length!==3?null:t}function T(r){const t=je(r);if(!t)return null;const e=new TextDecoder,n=K.decode(t[0],{strict:!1}),i=K.decode(t[1],{strict:!1}),s=JSON.parse(e.decode(n));if(typeof s!="object"||s===null||!("alg"in s)||!Me(s.alg)||"typ"in s&&s.typ!=="JWT")return null;const o=JSON.parse(e.decode(i));if(typeof o!="object"||o===null)return null;const a={algorithm:s.alg,expiresAt:null,subject:null,issuedAt:null,issuer:null,jwtId:null,audiences:null,notBefore:null};if("exp"in o){if(typeof o.exp!="number")return null;a.expiresAt=new Date(o.exp*1e3)}if("iss"in o){if(typeof o.iss!="string")return null;a.issuer=o.iss}if("sub"in o){if(typeof o.sub!="string")return null;a.subject=o.sub}if("aud"in o)if(Array.isArray(o.aud)){for(const c of o.aud)if(typeof c!="string")return null;a.audiences=o.aud}else{if(typeof o.aud!="string")return null;a.audiences=[o.aud]}if("nbf"in o){if(typeof o.nbf!="number")return null;a.notBefore=new Date(o.nbf*1e3)}if("iat"in o){if(typeof o.iat!="number")return null;a.issuedAt=new Date(o.iat*1e3)}if("jti"in o){if(typeof o.jti!="string")return null;a.jwtId=o.jti}return{value:r,header:{...s,typ:"JWT",alg:s.alg},payload:{...o},parts:t,...a}}function Me(r){return typeof r!="string"?!1:["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512"].includes(r)}var Ne=class extends Error{constructor(t=500,e){super(e==null?void 0:e.message,{cause:e==null?void 0:e.cause});d(this,"res");d(this,"status");this.res=e==null?void 0:e.res,this.status=t}getResponse(){return this.res?new Response(this.res.body,{status:this.status,headers:this.res.headers}):new Response(this.message,{status:this.status})}};const C=f.object({iss:f.string().url(),sub:f.string(),aud:f.string(),exp:f.number(),email:f.string().optional(),given_name:f.string().optional(),family_name:f.string().optional(),name:f.string().optional(),iat:f.number(),auth_time:f.number().optional(),nonce:f.string().optional(),acr:f.string().optional(),amr:f.array(f.string()).optional(),azp:f.string().optional(),at_hash:f.string().optional(),c_hash:f.string().optional()}).passthrough();C.omit({iat:!0,auth_time:!0,nonce:!0,acr:!0,amr:!0,azp:!0,at_hash:!0,c_hash:!0});function w(r){return r.OAUTH_API_URL||r.ISSUER}const se=({className:r=""})=>u("svg",{width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg",className:r,children:[u("path",{d:"M44.1035 23.0123C44.1054 21.4791 43.9758 19.9486 43.716 18.4375H22.498V27.1028H34.6507C34.4021 28.4868 33.8757 29.8061 33.1034 30.9812C32.3311 32.1562 31.3289 33.1628 30.1571 33.9401V39.5649H37.41C41.6567 35.6494 44.1035 29.859 44.1035 23.0123Z",fill:"#4285F4"}),u("path",{d:"M22.4982 44.9997C28.5698 44.9997 33.6821 43.0061 37.4101 39.5687L30.1573 33.9439C28.1386 35.3126 25.5387 36.0938 22.4982 36.0938C16.6296 36.0938 11.6485 32.1377 9.86736 26.8066H2.39575V32.6033C4.26839 36.3297 7.13989 39.4622 10.6896 41.6512C14.2394 43.8402 18.3277 44.9995 22.4982 44.9997Z",fill:"#34A853"}),u("path",{d:"M9.86737 26.8073C8.92572 24.0138 8.92572 20.9886 9.86737 18.1951V12.3984H2.39576C0.820432 15.5332 0 18.9929 0 22.5012C0 26.0095 0.820432 29.4692 2.39576 32.604L9.86737 26.8073Z",fill:"#FBBC04"}),u("path",{d:"M22.4982 8.90741C25.7068 8.85499 28.8071 10.0673 31.1291 12.2823L37.5507 5.86064C33.4788 2.03602 28.0843 -0.0637686 22.4982 0.00147616C18.3277 0.00166623 14.2394 1.16098 10.6896 3.34999C7.13989 5.539 4.26839 8.67155 2.39575 12.3979L9.86736 18.1946C11.6485 12.8635 16.6296 8.90741 22.4982 8.90741Z",fill:"#EA4335"})]}),oe=({className:r=""})=>u("svg",{width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg",className:r,children:[u("path",{d:"M45 22.5C45 10.0736 34.9264 0 22.5 0C10.0736 0 0 10.0736 0 22.5C0 33.7031 8.23242 42.9785 19.0039 44.6953V28.9746H13.2861V22.5H19.0039V17.5391C19.0039 11.8945 22.3828 8.75977 27.5391 8.75977C29.9658 8.75977 32.5049 9.19922 32.5049 9.19922V14.7656H29.7012C26.9414 14.7656 26.0156 16.4824 26.0156 18.2432V22.5H32.2412L31.2012 28.9746H26.0156V44.6953C36.7871 42.9785 45 33.7031 45 22.5Z",fill:"#1877F2"}),u("path",{d:"M31.2012 28.9746L32.2412 22.5H26.0156V18.2432C26.0156 16.4824 26.9414 14.7656 29.7012 14.7656H32.5049V9.19922C32.5049 9.19922 29.9658 8.75977 27.5391 8.75977C22.3828 8.75977 19.0039 11.8945 19.0039 17.5391V22.5H13.2861V28.9746H19.0039V44.6953C20.1562 44.8984 21.3203 45 22.5 45C23.6797 45 24.8438 44.8984 26.0156 44.6953V28.9746H31.2012Z",fill:"white"})]}),ae=({className:r=""})=>u("svg",{width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg",className:r,children:u("path",{d:"M32.6 24.4c-.1 2.7 1.2 5.2 3.4 6.6-1.3 1.8-3.1 3.2-5.2 3.8-2.2.7-4.5.3-6.4-.9-1.8-1.2-4.1-1.2-5.9 0-2.5 1.6-5.6 2-8.4.9-2.9-1.1-5.3-3.3-6.8-6-3.2-5.4-3.7-12.1-.9-17.7 1.4-2.8 4.1-4.6 7.1-4.7 2.1-.1 4.1.7 5.6 2.1.8.7 1.6 1.3 2.6 1.3 1 0 1.9-.6 2.8-1.3 2.2-1.8 5.3-2.4 8-1.5 2.2.7 4.1 2.3 5.2 4.4-4.6 2.7-6.2 8.6-3.5 13.2.5.8 1 1.5 1.6 2.1l.8.7zm-8.9-22C25.4.7 27.7-.2 30-.1c.2 2.3-.6 4.5-2.3 6.2-1.7 1.7-4 2.7-6.4 2.6-.2-2.3.7-4.6 2.4-6.3z",fill:"currentColor"})}),ce=({className:r=""})=>u("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"45",height:"45",className:r,children:[u("path",{fill:"#FF5B24",d:"M3.5,8h41c1.9,0,3.5,1.6,3.5,3.5v25c0,1.9-1.6,3.5-3.5,3.5h-41C1.6,40,0,38.4,0,36.5v-25C0,9.6,1.6,8,3.5,8z"}),u("path",{fillRule:"evenodd",clipRule:"evenodd",fill:"#FFFFFF",d:`M27.9,20.3c1.4,0,2.6-1,2.6-2.5h0c0-1.5-1.2-2.5-2.6-2.5c-1.4,0-2.6,1-2.6,2.5C25.3,19.2,26.5,20.3,27.9,20.3z
    M31.2,24.4c-1.7,2.2-3.5,3.8-6.7,3.8h0c-3.2,0-5.8-2-7.7-4.8c-0.8-1.2-2-1.4-2.9-0.8c-0.8,0.6-1,1.8-0.3,2.9
   c2.7,4.1,6.5,6.6,10.9,6.6c4,0,7.2-2,9.6-5.2c0.9-1.2,0.9-2.5,0-3.1C33.3,22.9,32.1,23.2,31.2,24.4z`})]}),le=({className:r=""})=>u("svg",{width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg",className:r,children:u("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.5 0C10.074 0 0 10.335 0 23.077C0 33.266 6.444 41.895 15.39 44.955C16.515 45.165 16.935 44.46 16.935 43.857C16.935 43.32 16.92 41.865 16.905 39.99C10.65 41.355 9.33 36.99 9.33 36.99C8.31 34.32 6.825 33.615 6.825 33.615C4.77 32.205 6.975 32.235 6.975 32.235C9.24 32.385 10.425 34.59 10.425 34.59C12.45 38.13 15.75 37.125 17.01 36.555C17.22 35.07 17.82 34.065 18.48 33.51C13.455 32.94 8.19 30.93 8.19 22.035C8.19 19.5 9.075 17.43 10.47 15.81C10.23 15.24 9.435 12.87 10.695 9.66C10.695 9.66 12.585 9.045 16.875 12.06C18.675 11.565 20.595 11.31 22.5 11.31C24.405 11.31 26.325 11.565 28.125 12.06C32.415 9.045 34.305 9.66 34.305 9.66C35.565 12.87 34.77 15.24 34.53 15.81C35.925 17.43 36.81 19.5 36.81 22.035C36.81 30.96 31.53 32.925 26.49 33.48C27.33 34.2 28.095 35.625 28.095 37.815C28.095 40.95 28.065 43.47 28.065 43.857C28.065 44.46 28.485 45.18 29.625 44.955C38.571 41.88 45 33.252 45 23.077C45 10.335 34.926 0 22.5 0Z",fill:"currentColor"})}),de=({className:r=""})=>u("svg",{width:"45",height:"45",viewBox:"0 0 45 45",xmlns:"http://www.w3.org/2000/svg",className:r,children:[u("path",{fill:"#F25022",d:"M0 0H21.43V21.43H0V0Z"}),u("path",{fill:"#7FBA00",d:"M23.57 0H45V21.43H23.57V0Z"}),u("path",{fill:"#00A4EF",d:"M0 23.57H21.43V45H0V23.57Z"}),u("path",{fill:"#FFB900",d:"M23.57 23.57H45V45H23.57V23.57Z"})]});se.__docgenInfo={description:"",methods:[],displayName:"GoogleLogo",props:{className:{defaultValue:{value:'""',computed:!1},required:!1}}};oe.__docgenInfo={description:"",methods:[],displayName:"FacebookLogo",props:{className:{defaultValue:{value:'""',computed:!1},required:!1}}};ae.__docgenInfo={description:"",methods:[],displayName:"AppleLogo",props:{className:{defaultValue:{value:'""',computed:!1},required:!1}}};ce.__docgenInfo={description:"",methods:[],displayName:"VippsLogo",props:{className:{defaultValue:{value:'""',computed:!1},required:!1}}};le.__docgenInfo={description:"",methods:[],displayName:"GitHubLogo",props:{className:{defaultValue:{value:'""',computed:!1},required:!1}}};de.__docgenInfo={description:"",methods:[],displayName:"MicrosoftLogo",props:{className:{defaultValue:{value:'""',computed:!1},required:!1}}};const qe="Apple",Ve=ae;function he(r){const{options:t}=r;if(!t||!t.client_id||!t.team_id||!t.kid||!t.app_secret)throw new Error("Missing required Apple authentication parameters");const e=Buffer.from(t.app_secret,"utf-8"),n=e.toString().replace(/-----BEGIN PRIVATE KEY-----|-----END PRIVATE KEY-----|\s/g,""),i=Uint8Array.from(Buffer.from(n,"base64"));return e.fill(0),{options:t,keyArray:i}}async function Oe(r,t){var l,h;const{options:e,keyArray:n}=he(t),i=`${w(r.env)}callback`,s=new Q(e.client_id,e.team_id,e.kid,n,i),o=v(),a=await s.createAuthorizationURL(o,((l=e.scope)==null?void 0:l.split(" "))||["name","email"]);return(((h=e.scope)==null?void 0:h.split(" "))||["name","email"]).some(p=>["email","name"].includes(p))&&a.searchParams.set("response_mode","form_post"),{redirectUrl:a.href,code:o}}async function Fe(r,t,e){const{options:n,keyArray:i}=he(t),o=await new Q(n.client_id,n.team_id,n.kid,i,`${w(r.env)}callback`).validateAuthorizationCode(e),a=T(o.idToken());if(!a)throw new Error("Invalid ID token");const c=C.parse(a.payload);return{sub:c.sub,email:c.email,given_name:c.given_name,family_name:c.family_name,name:c.name,picture:c.picture,locale:c.locale}}const Ge=Object.freeze(Object.defineProperty({__proto__:null,displayName:qe,getRedirect:Oe,logo:Ve,validateAuthorizationCodeAndGetUser:Fe},Symbol.toStringTag,{value:"Module"})),Je="Facebook",Ke=oe;async function Ze(r,t){var a;const{options:e}=t;if(!(e!=null&&e.client_id)||!e.client_secret)throw new Error("Missing required authentication parameters");const n=`${w(r.env)}callback`,i=new X(e.client_id,e.client_secret,n),s=v();return{redirectUrl:i.createAuthorizationURL(s,((a=e.scope)==null?void 0:a.split(" "))||["email"]).href,code:s}}async function De(r,t,e){const{options:n}=t;if(!(n!=null&&n.client_id)||!n.client_secret)throw new Error("Missing required authentication parameters");const s=await new X(n.client_id,n.client_secret,`${w(r.env)}callback`).validateAuthorizationCode(e),o=await fetch("https://graph.facebook.com/v22.0/me?fields=id,email,name",{headers:{Authorization:`Bearer ${s.accessToken()}`}});if(!o.ok)throw new Error("Failed to fetch user info");const a=await o.json();return r.set("log",`Userinfo: ${JSON.stringify(a)}`),{sub:a.id,email:a.email,name:a.name}}const We=Object.freeze(Object.defineProperty({__proto__:null,displayName:Je,getRedirect:Ze,logo:Ke,validateAuthorizationCodeAndGetUser:De},Symbol.toStringTag,{value:"Module"})),Ye="Google",Qe=se;async function Xe(r,t){var c;const{options:e}=t;if(!(e!=null&&e.client_id)||!e.client_secret)throw new Error("Missing required Google authentication parameters");const n=`${w(r.env)}callback`,i=new te(e.client_id,e.client_secret,n),s=v(),o=Y();return{redirectUrl:i.createAuthorizationURL(s,o,((c=e.scope)==null?void 0:c.split(" "))??["email","profile"]).href,code:s,codeVerifier:o}}async function et(r,t,e,n){const{options:i}=t;if(!(i!=null&&i.client_id)||!i.client_secret||!n)throw new Error("Missing required authentication parameters");const o=await new te(i.client_id,i.client_secret,`${w(r.env)}callback`).validateAuthorizationCode(e,n),a=T(o.idToken());if(!a)throw new Error("Invalid ID token");const c=C.parse(a.payload);return{sub:c.sub,email:c.email,given_name:c.given_name,family_name:c.family_name,name:c.name,picture:c.picture,locale:c.locale}}const tt=Object.freeze(Object.defineProperty({__proto__:null,displayName:Ye,getRedirect:Xe,logo:Qe,validateAuthorizationCodeAndGetUser:et},Symbol.toStringTag,{value:"Module"})),nt="Vipps",rt=ce;async function it(r,t){var o;const{options:e}=t;if(!(e!=null&&e.client_id)||!e.client_secret)throw new Error("Missing required authentication parameters");const n=new S(e.client_id,e.client_secret,`${w(r.env)}callback`),i=v(),s=n.createAuthorizationURL("https://api.vipps.no/access-management-1.0/access/oauth2/auth",i,((o=e.scope)==null?void 0:o.split(" "))||["openid","email","phoneNumber","name","address","birthDate"]);return s.searchParams.set("response_type","code"),s.searchParams.set("response_mode","query"),{redirectUrl:s.href,code:i}}async function st(r,t,e){const{options:n}=t;if(!(n!=null&&n.client_id)||!n.client_secret)throw new Error("Missing required authentication parameters");const s=await new S(n.client_id,n.client_secret,`${w(r.env)}callback`).validateAuthorizationCode("https://api.vipps.no/access-management-1.0/access/oauth2/token",e,null),o=T(s.idToken());if(!o)throw new Error("Invalid ID token");const a=C.parse(o.payload);if(typeof a.msn!="string")throw new Error("msn not available in id token");const c=await fetch("https://api.vipps.no/vipps-userinfo-api/userinfo",{headers:{Authorization:`Bearer ${s.accessToken()}`,"Merchant-Serial-Number":a.msn}});if(!c.ok)throw new Ne(400,{message:"Failed to get user from vipps"});return await c.json()}const ot=Object.freeze(Object.defineProperty({__proto__:null,displayName:nt,getRedirect:it,logo:rt,validateAuthorizationCodeAndGetUser:st},Symbol.toStringTag,{value:"Module"})),at="GitHub",ct=le;async function lt(r,t){var a;const{options:e}=t;if(!(e!=null&&e.client_id)||!e.client_secret)throw new Error("Missing required GitHub authentication parameters");const n=`${w(r.env)}callback`,i=new ee(e.client_id,e.client_secret,n),s=v();return{redirectUrl:i.createAuthorizationURL(s,((a=e.scope)==null?void 0:a.split(" "))||["user:email"]).href,code:s}}async function dt(r,t,e){var h,p;const{options:n}=t;if(!(n!=null&&n.client_id)||!n.client_secret)throw new Error("Missing required authentication parameters");const s=await new ee(n.client_id,n.client_secret,`${w(r.env)}callback`).validateAuthorizationCode(e),o=await fetch("https://api.github.com/user",{headers:{Authorization:`Bearer ${s.accessToken()}`,"User-Agent":"AuthHero"}});if(!o.ok)throw new Error("Failed to fetch user info");const a=await o.json(),c=await fetch("https://api.github.com/user/emails",{headers:{Authorization:`Bearer ${s.accessToken()}`,"User-Agent":"AuthHero"}});let l=a.email;if(c.ok){const g=await c.json(),E=g.find(x=>x.primary&&x.verified)||g.find(x=>x.verified);E&&(l=E.email)}return r.set("log",`GitHub user: ${JSON.stringify(a)}`),{sub:a.id.toString(),email:l,name:a.name,given_name:(h=a.name)==null?void 0:h.split(" ")[0],family_name:(p=a.name)==null?void 0:p.split(" ").slice(1).join(" "),picture:a.avatar_url}}const ht=Object.freeze(Object.defineProperty({__proto__:null,displayName:at,getRedirect:lt,logo:ct,validateAuthorizationCodeAndGetUser:dt},Symbol.toStringTag,{value:"Module"})),ut="Microsoft",ft=de;async function pt(r,t){var l;const{options:e}=t;if(!(e!=null&&e.client_id)||!e.client_secret)throw new Error("Missing required Microsoft authentication parameters");const n=`${w(r.env)}callback`,i=e.realms||"common",s=new ne(i,e.client_id,e.client_secret,n),o=v(),a=Y();return{redirectUrl:s.createAuthorizationURL(o,a,((l=e.scope)==null?void 0:l.split(" "))||["openid","profile","email"]).href,code:o,codeVerifier:a}}async function wt(r,t,e,n){const{options:i}=t;if(!(i!=null&&i.client_id)||!i.client_secret||!n)throw new Error("Missing required authentication parameters");const s=i.realms||"common",a=await new ne(s,i.client_id,i.client_secret,`${w(r.env)}callback`).validateAuthorizationCode(e,n),c=T(a.idToken());if(!c)throw new Error("Invalid ID token");const l=C.parse(c.payload);return r.set("log",`Microsoft user: ${JSON.stringify(l)}`),{sub:l.sub,email:l.email,given_name:l.given_name,family_name:l.family_name,name:l.name,picture:l.picture}}const bt=Object.freeze(Object.defineProperty({__proto__:null,displayName:ut,getRedirect:pt,logo:ft,validateAuthorizationCodeAndGetUser:wt},Symbol.toStringTag,{value:"Module"}));function xt(r){return{apple:Ge,facebook:We,"google-oauth2":tt,vipps:ot,github:ht,microsoft:bt}[r]}export{xt as g};
