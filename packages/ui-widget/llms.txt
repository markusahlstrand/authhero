# @authhero/widget

> Server-Driven UI widget for AuthHero authentication flows - framework-agnostic web components.

## Overview

A StencilJS-based web component that renders authentication UI based on server-provided configurations. Compatible with Auth0 Forms API schema for universal login flows.

## Installation

```bash
npm install @authhero/widget
```

## Features

- **Auth0 Forms Compatible** - Uses Auth0's Forms API schema
- **Server-Driven UI (SDUI)** - Server controls what UI to render
- **Zero-Deploy Updates** - Update auth flows without widget redeployment
- **Event-Based Architecture** - Pure UI component with event emissions
- **Framework Agnostic** - Works with React, Vue, Angular, vanilla JS
- **SSR Support** - Includes hydrate scripts for server-side rendering
- **Customizable** - CSS custom properties for branding

## Usage

### Browser (CDN)

```html
<script type="module" src="https://unpkg.com/@authhero/widget/dist/authhero-widget/authhero-widget.esm.js"></script>

<authhero-widget 
  api-url="/u/flow/screen"
  auto-submit="false">
</authhero-widget>
```

### JavaScript Framework

```javascript
import '@authhero/widget';

// Or with lazy-loading
import { defineCustomElements } from '@authhero/widget/loader';
defineCustomElements();
```

```html
<authhero-widget 
  api-url="/u/flow/screen"
  auto-submit="false">
</authhero-widget>
```

### Server-Side Rendering (Hono)

```typescript
import { renderToString } from '@authhero/widget/hydrate';

const html = await renderToString(`
  <authhero-widget screen='${JSON.stringify(screenConfig)}'></authhero-widget>
`);
```

## Component Types

Supports 27+ Auth0 component types:

| Component | Description |
|-----------|-------------|
| `heading` | Page headings and titles |
| `description` | Descriptive text |
| `text-input` | Text, email, phone inputs |
| `password-input` | Password field with toggle |
| `checkbox-input` | Checkboxes |
| `select-input` | Dropdown selects |
| `submit-button` | Primary action buttons |
| `button` | Secondary action buttons |
| `social-button-group` | Social login buttons |
| `anchor` | Links and navigation |
| `separator` | Visual dividers |
| `image` | Logos and images |
| `phone-input` | Phone number input |
| `captcha` | CAPTCHA verification |
| `mfa` | Multi-factor authentication |

## Screen Configuration

```typescript
interface UIScreen {
  title?: string;
  description?: string;
  components: UIComponent[];
  branding?: {
    logoUrl?: string;
    primaryColor?: string;
    backgroundColor?: string;
  };
  theme?: string;
}

interface UIComponent {
  id: string;
  type: string;
  label?: string;
  placeholder?: string;
  required?: boolean;
  // ... component-specific properties
}
```

## Events

```javascript
const widget = document.querySelector('authhero-widget');

// Form submission
widget.addEventListener('submit', (event) => {
  const { action, data } = event.detail;
  // Handle form submission
});

// Navigation
widget.addEventListener('navigate', (event) => {
  const { href } = event.detail;
  // Handle navigation
});

// Social login
widget.addEventListener('social-login', (event) => {
  const { provider } = event.detail;
  // Redirect to social provider
});
```

## Attributes

| Attribute | Type | Description |
|-----------|------|-------------|
| `api-url` | string | Endpoint for fetching screen config |
| `screen` | string | JSON screen configuration |
| `auto-submit` | boolean | Auto-submit on single action |
| `state` | string | Auth state parameter |

## CSS Custom Properties

```css
authhero-widget {
  --ah-primary-color: #635dff;
  --ah-background-color: #ffffff;
  --ah-text-color: #1e1e1e;
  --ah-error-color: #dc2626;
  --ah-border-radius: 8px;
  --ah-font-family: Inter, sans-serif;
}
```

## Integration with AuthHero

```typescript
// Server-side (Hono)
app.get("/u/flow/screen", async (c) => {
  return c.json({
    title: "Log in",
    components: [
      { type: "heading", text: "Welcome" },
      { type: "text-input", id: "email", label: "Email" },
      { type: "password-input", id: "password", label: "Password" },
      { type: "submit-button", text: "Continue" },
    ],
  });
});
```

## Key Files

- `src/components/` - StencilJS components
- `src/components/authhero-widget/` - Main widget component
- `src/utils/` - Utility functions
- `dist/` - Built distribution files
- `hydrate/` - SSR hydration scripts

## Related Packages

- `authhero` - Core authentication library
- Auth0 Forms API - Schema compatibility

## License

MIT License
